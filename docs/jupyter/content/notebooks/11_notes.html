
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Week 11 - Notes: The Euler-Lagrange Equation &#8212; My Jupyter Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/notebooks/11_notes';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Week 12 - The Principle of Least Action" href="12_start.html" />
    <link rel="prev" title="Week 11 - Calculus of Variations" href="11_start.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">My Jupyter Book</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to Modern Classical Mechanics
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_start.html">Week 1 - Overture: What is Classical Physics?</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_notes.html">Week 1 - Notes: Introduction to Classical Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_start.html">Week 2 - Computing as a tool for science</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_notes.html">Week 2 - Notes: Mathematical Preliminaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_start.html">Week 3 - What is Mathematical Modeling?</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_notes.html">Week 3 - Notes: Making Classical Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_start.html">Week 4 - Why does fluid drag complicate things?</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_notes.html">Week 4 - Notes: Equations of Motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_start.html">Week 5 - Conservation Laws</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_notes.html">Week 5 - Notes: Conservation of Energy</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_start.html">Week 6 - Stability and Equilibria</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_notes.html">Week 6 - Notes: Stability and Energy</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_notes_2.html">Week 6 - Notes: Linear and Angular Momentum</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_start.html">Week 7 - Nonlinear Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_notes.html">Week 7 - Notes: Critical Points; Phase Space; Trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_start.html">Week 8 - Oscillations</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_notes.html">Week 8 - Notes: Oscillators and Modeling Oscillations</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_start.html">Week 9 - Driven Oscillators and Resonance</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_notes.html">Week 9 - Notes: Driven Oscillations</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_start.html">Week 10 - Chaotic Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_notes.html">Week 10 - Activity: Modeling Chaotic Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_start.html">Week 11 - Calculus of Variations</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Week 11 - Notes: The Euler-Lagrange Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_start.html">Week 12 - The Principle of Least Action</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_notes.html">Week 12 - Notes: Introduction to Lagrangian Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="13_start.html">Week 13 - Lagrangian Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="13_notes.html">Week 13 - Notes: Examples of Lagrangian Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="hw1.html">Homework 1 (Due 24 Jan)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hw2.html">Homework 2 (Due 31 Jan)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hw3.html">Homework 3 (Due 07 Feb)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hw4.html">Homework 4 (Due 17 Feb)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hw5.html">Homework 5 (Due 14 Mar)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hw6.html">Homework 6 (Due 21 Mar)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hw7.html">Homework 7 (Due 28 Mar)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hw8.html">Homework 8 (Due 18 Apr)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/notebooks/11_notes.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Week 11 - Notes: The Euler-Lagrange Equation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#canonical-conceptualization-finding-the-shortest-path-in-a-plane">Canonical Conceptualization - Finding the Shortest Path in a Plane</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-of-the-problem">Setup of the Problem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deriving-the-euler-lagrange-equation">Deriving the Euler-Lagrange Equation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-by-parts">Integration by Parts</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#back-to-the-shortest-path-example">Back to the Shortest Path Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-snell-s-law">Example: Snell’s Law</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-brachistochrone-problem">Example: Brachistochrone Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#velocity-of-the-bead">Velocity of the Bead</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="week-11-notes-the-euler-lagrange-equation">
<h1>Week 11 - Notes: The Euler-Lagrange Equation<a class="headerlink" href="#week-11-notes-the-euler-lagrange-equation" title="Link to this heading">#</a></h1>
<p>As we will use it, the <a class="reference external" href="https://en.wikipedia.org/wiki/Calculus_of_variations">Calculus of Variations</a> foucses on finding the conditions of extrema for quantities that can be expressed as an integral. This might be a very abstract concept, so we will start with a simple example.</p>
<p>This approach might seem a bit alien at first, but it turns out to be an interesting way to develop an equivalent formulation of mechanics. Moreover, the Calculus of Variations is a powerful tool in many fields, and forms the basis for <a class="reference external" href="https://en.wikipedia.org/wiki/Lagrangian_mechanics">Lagrangian mechanics</a>.</p>
<p>To do this, we will derive (in 1D) the <a class="reference external" href="https://en.wikipedia.org/wiki/Euler%E2%80%93Lagrange_equation">Euler-Lagrange equation</a>. This equation gives us a way to find the function that makes the integral of a given functional stationary (i.e., a local maximum or minimum).</p>
<section id="canonical-conceptualization-finding-the-shortest-path-in-a-plane">
<h2>Canonical Conceptualization - Finding the Shortest Path in a Plane<a class="headerlink" href="#canonical-conceptualization-finding-the-shortest-path-in-a-plane" title="Link to this heading">#</a></h2>
<p>Using the Calculus of Variations, we can show that the shortest path between two points in a plane is a straight line. This is a classic example, but it illustrates the concept well. Consider a general path in two-dimensional space that connects two points, say <span class="math notranslate nohighlight">\(s_1 = \langle x_1, y_1 \rangle\)</span> and <span class="math notranslate nohighlight">\(s_2 = \langle x_2, y_2 \rangle\)</span>. We can represent this path as a function <span class="math notranslate nohighlight">\(y(x)\)</span>. The figure below illustrates the setup.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-v0_8-colorblind&#39;</span><span class="p">)</span>

<span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ygeneric</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">xvals</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">xvals</span><span class="o">**</span><span class="mi">2</span>
<span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">ygeneric</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ygeneric</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">ygeneric</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Generic Path, $y(x)$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Shortest Path&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;C2o&#39;</span><span class="p">)</span>  <span class="c1"># Point 1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="s1">&#39;C2o&#39;</span><span class="p">)</span>  <span class="c1"># Point 2</span>

<span class="c1"># blank ticks</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>  <span class="c1"># Remove x ticks</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>  <span class="c1"># Remove y ticks</span>

<span class="c1"># Set labels and title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Shortest Path Between Two Points in a Plane&#39;</span><span class="p">)</span>
<span class="c1"># Add a legend to the plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="c1"># Show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Add grid for better readability</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Display the plot</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/c47b8fdcacd55bad69c500f971be17d258e29c68bc2e29db7523305132a1ac13.png" src="../../_images/c47b8fdcacd55bad69c500f971be17d258e29c68bc2e29db7523305132a1ac13.png" />
</div>
</div>
<p>The blue solid line is the ‘generic path’ that connects the two points <span class="math notranslate nohighlight">\(s_1\)</span> and <span class="math notranslate nohighlight">\(s_2\)</span>. The green dotted line is the solution that we expect to get when we ask, “what is the shortest path between these two points?”</p>
<section id="setup-of-the-problem">
<h3>Setup of the Problem<a class="headerlink" href="#setup-of-the-problem" title="Link to this heading">#</a></h3>
<p>Let’s take a generic segment of the path <span class="math notranslate nohighlight">\(ds\)</span> and express it in terms of its differential elements:</p>
<div class="math notranslate nohighlight">
\[ds = \sqrt{dx^2 + dy^2}.\]</div>
<p>The length of the path from <span class="math notranslate nohighlight">\(s_1\)</span> to <span class="math notranslate nohighlight">\(s_2\)</span> can be expressed as an integral:</p>
<div class="math notranslate nohighlight">
\[l = \int_{s_1}^{s_2} ds\]</div>
<p>We want to minimize this length, <span class="math notranslate nohighlight">\(l\)</span>, which is the total length of the path. To do this, we are attempting to minimize the integral of <span class="math notranslate nohighlight">\(ds\)</span> over the path. This is where the Calculus of Variations comes in.</p>
<p>Let’s write the expression for <span class="math notranslate nohighlight">\(ds\)</span> in a more convenient form. We can factor out the <span class="math notranslate nohighlight">\(dx\)</span> term:</p>
<div class="math notranslate nohighlight">
\[ds = \sqrt{dx^2 + dy^2} = dx \sqrt{1 + \left(\frac{dy}{dx}\right)^2} = dx = \sqrt{1 + y'(x)^2}\]</div>
<p>where <span class="math notranslate nohighlight">\(y'(x) = \frac{dy}{dx}\)</span> is the derivative of <span class="math notranslate nohighlight">\(y\)</span> with respect to <span class="math notranslate nohighlight">\(x\)</span>. So the integral for the length of the path becomes:</p>
<div class="math notranslate nohighlight">
\[l = \int_{x_1}^{x_2} dx \sqrt{1 + y'(x)^2}.\]</div>
<p>The function <span class="math notranslate nohighlight">\(y(x)\)</span> defines the path that minimizes the length <span class="math notranslate nohighlight">\(l\)</span>. To find this path, we assume an incorrect function <span class="math notranslate nohighlight">\(Y(x)\)</span> that is close to the true path <span class="math notranslate nohighlight">\(y(x)\)</span>, and we can express the difference between them as <span class="math notranslate nohighlight">\(\alpha\eta(x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[Y(x) = \underbrace{y(x)}_{\textrm{correct}}+ \underbrace{\alpha\eta(x)}_{\textrm{minimize}}\]</div>
<p>Note that <span class="math notranslate nohighlight">\(Y(x_1) = y(x_1)\)</span> and <span class="math notranslate nohighlight">\(Y(x_2) = y(x_2)\)</span>, so the endpoints of the path are fixed. The function <span class="math notranslate nohighlight">\(\eta(x)\)</span> represents a small perturbation to the path, and <span class="math notranslate nohighlight">\(\alpha\)</span> is a small parameter that we will use to control the size of the perturbation.</p>
</section>
<section id="deriving-the-euler-lagrange-equation">
<h3>Deriving the Euler-Lagrange Equation<a class="headerlink" href="#deriving-the-euler-lagrange-equation" title="Link to this heading">#</a></h3>
<p>The mathematical derivation involves extremizing the integral using a perturbation approach. The generic integral we are trying to minimize is for a function of the form:</p>
<div class="math notranslate nohighlight">
\[f(y(x),y'(x),x)),\]</div>
<p>where <span class="math notranslate nohighlight">\(f\)</span> is a function of <span class="math notranslate nohighlight">\(y\)</span>, its derivative <span class="math notranslate nohighlight">\(y'\)</span>, and the independent variable <span class="math notranslate nohighlight">\(x\)</span>. So that the integral we are minimizing can be expressed as:</p>
<div class="math notranslate nohighlight">
\[S=\int_{x_1}^{x_2} f(y(x),y'(x),x) dx.\]</div>
<p>We assume <span class="math notranslate nohighlight">\(y(x)\)</span> minimizes the integral <span class="math notranslate nohighlight">\(S\)</span>. So that any function <span class="math notranslate nohighlight">\(Y(x) = y(x) + \alpha\eta(x)\)</span> produces a larger value for <span class="math notranslate nohighlight">\(S\)</span>,</p>
<div class="math notranslate nohighlight">
\[\int_{s_1}^{s_2} f(Y(x),Y'(x),x) dx &gt; \int_{s_1}^{s_2} f(y(x),y'(x),x) dx.\]</div>
<p>Because we are looking for a minimum, we notice that when <span class="math notranslate nohighlight">\(\alpha = 0\)</span>, we have <span class="math notranslate nohighlight">\(Y(x) = y(x)\)</span>, and the integral is at its minimum. To find the extremum, we can take the derivative of the integral with respect to <span class="math notranslate nohighlight">\(\alpha\)</span> and set it to zero:</p>
<div class="math notranslate nohighlight">
\[\dfrac{dS}{d\alpha}|_{\alpha=0} = 0.\]</div>
<p>We start that analysis by differentiating the integral with respect to <span class="math notranslate nohighlight">\(\alpha\)</span>:</p>
<div class="math notranslate nohighlight">
\[S = \int_{x_1}^{x_2} f(Y(x),Y'(x),x) dx\]</div>
<div class="math notranslate nohighlight">
\[S = \int_{x_1}^{x_2} f(y(x) + \alpha\eta(x), y'(x) + \alpha\eta'(x), x) dx.\]</div>
<p>We can now differentiate.</p>
<div class="math notranslate nohighlight">
\[\dfrac{dS}{d\alpha} = \int_{x_1}^{x_2} \left[ \dfrac{\partial f}{\partial Y}\dfrac{dY}{d\alpha} + \dfrac{\partial f}{\partial Y'}\dfrac{dY'}{d\alpha} + \dfrac{\partial f}{\partial x}\dfrac{dx}{d\alpha} \right] dx.\]</div>
<div class="math notranslate nohighlight">
\[\dfrac{dS}{d\alpha} = \dfrac{dY'}{d\alpha}+ \dfrac{\partial f}{\partial x}\dfrac{dx}{d\alpha} dx.\]</div>
<p>Let’s take each term in turn. The first term is:</p>
<div class="math notranslate nohighlight">
\[\dfrac{df}{dY}\dfrac{dY}{d\alpha}.\]</div>
<p>Let’s focus on the second part of that term:</p>
<div class="math notranslate nohighlight">
\[\dfrac{dY}{d\alpha} = \dfrac{d}{d\alpha}\left[y(x) + \alpha\eta(x)\right] = \eta(x).\]</div>
<p>Let’s look at the second term:</p>
<div class="math notranslate nohighlight">
\[\dfrac{dY'}{d\alpha}.\]</div>
<p>Again, let’s focus on the second part of that term:</p>
<div class="math notranslate nohighlight">
\[\dfrac{dY'}{d\alpha} = \dfrac{d}{d\alpha}\left[y'(x) + \alpha\eta'(x)\right] = \eta'(x).\]</div>
<p>Lastly, the third term:</p>
<div class="math notranslate nohighlight">
\[\dfrac{\partial f}{\partial x}\dfrac{dx}{d\alpha}=0.\]</div>
<p>This term is a bit different. The <span class="math notranslate nohighlight">\(dx\)</span> term is independent of <span class="math notranslate nohighlight">\(\alpha\)</span>, so we can treat it as a constant with respect to <span class="math notranslate nohighlight">\(\alpha\)</span>. Therefore, this term will not contribute to the derivative with respect to <span class="math notranslate nohighlight">\(\alpha\)</span>, and we can ignore it in our analysis.</p>
<p>Putting it all together, we have:</p>
<div class="math notranslate nohighlight">
\[\dfrac{dS}{d\alpha} = \int_{x_1}^{x_2}\left[ \dfrac{\partial f}{\partial Y}\eta(x) + \dfrac{\partial f}{\partial Y'}\eta'(x) \right] dx.\]</div>
<p>Our expression is still in terms of <span class="math notranslate nohighlight">\(Y(x)\)</span>, the incorrect function. We want to express it in terms of <span class="math notranslate nohighlight">\(y(x)\)</span>, the correct function. Let’s look at the derivatives <span class="math notranslate nohighlight">\(\dfrac{\partial f}{\partial Y}\)</span> and <span class="math notranslate nohighlight">\(\dfrac{\partial f}{\partial Y'}\)</span>. We can use the chain rule to express these derivatives in terms of <span class="math notranslate nohighlight">\(y(x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\dfrac{\partial f}{\partial Y} = \dfrac{\partial f}{\partial y}\dfrac{\partial y}{\partial Y} = \dfrac{\partial f}{\partial y},\]</div>
<div class="math notranslate nohighlight">
\[\dfrac{\partial f}{\partial Y'} = \dfrac{\partial f}{\partial y'}\dfrac{\partial y'}{\partial Y'} = \dfrac{\partial f}{\partial y'}.\]</div>
<p><strong>Why?</strong> Because <span class="math notranslate nohighlight">\(\dfrac{\partial y}{\partial Y} = 1\)</span> and <span class="math notranslate nohighlight">\(\dfrac{\partial y'}{\partial Y'} = 1\)</span> when we are differentiating with respect to the correct function <span class="math notranslate nohighlight">\(y(x)\)</span>. This means that we can express the derivatives in terms of the correct function <span class="math notranslate nohighlight">\(y(x)\)</span>.</p>
<div class="math notranslate nohighlight">
\[\dfrac{dS}{d\alpha} = \int_{x_1}^{x_2}\left[ \dfrac{\partial f}{\partial y}\eta(x) + \dfrac{\partial f}{\partial y'}\eta'(x) \right] dx.\]</div>
<p>We are seeking <span class="math notranslate nohighlight">\(\dfrac{dS}{d\alpha}\)</span> at <span class="math notranslate nohighlight">\(\alpha = 0\)</span>, so we set the integral to zero:</p>
<div class="math notranslate nohighlight">
\[\int_{x_1}^{x_2}\left[ \dfrac{\partial f}{\partial y}\eta(x) + \dfrac{\partial f}{\partial y'}\eta'(x) \right] dx = 0.\]</div>
<section id="integration-by-parts">
<h4>Integration by Parts<a class="headerlink" href="#integration-by-parts" title="Link to this heading">#</a></h4>
<p>Now to deal with the integral here, we can use integration by parts:</p>
<div class="math notranslate nohighlight">
\[\int u'v dx = [uv] - \int u v' dx\]</div>
<p>The first term <span class="math notranslate nohighlight">\([uv]\)</span> is called the “surface term” because it is the result of the integral and is evaluated at the boundaries of the integral, <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span>. We will apply integration by parts only to the second term in the integral.</p>
<p>Here, we note <span class="math notranslate nohighlight">\(u = \eta(x)\)</span> and <span class="math notranslate nohighlight">\(v = \dfrac{\partial f}{\partial y'}\)</span>. Then, we can express the second term in the integral as follows:</p>
<div class="math notranslate nohighlight">
\[\int_{x_1}^{x_2} \eta'(x) \dfrac{\partial f}{\partial y'} dx = \underbrace{\left[ \eta(x) \dfrac{\partial f}{\partial y'} \right]_{x_1}^{x_2}}_{\eta(x_1)=\eta(x_2)=0} - \int_{x_1}^{x_2} \eta(x) \dfrac{d}{dx}\left( \dfrac{\partial f}{\partial y'} \right) dx\]</div>
<div class="math notranslate nohighlight">
\[\int_{x_1}^{x_2} \eta'(x) \dfrac{\partial f}{\partial y'} dx = - \int_{x_1}^{x_2} \eta(x) \dfrac{d}{dx}\left( \dfrac{\partial f}{\partial y'} \right) dx\]</div>
<p>Notice that the surface term evaluates to zero because we have fixed the endpoints of the path, so <span class="math notranslate nohighlight">\(\eta(x_1) = \eta(x_2) = 0\)</span>.  We put this all together to get:</p>
<div class="math notranslate nohighlight">
\[\dfrac{dS}{d\alpha} = \int_{x_1}^{x_2}\left[ \eta(x)\dfrac{\partial f}{\partial y} - \eta(x) \dfrac{d}{dx}\left( \dfrac{\partial f}{\partial y'} \right) \right] dx = 0.\]</div>
<div class="math notranslate nohighlight">
\[\dfrac{dS}{d\alpha} = \int_{x_1}^{x_2} \eta(x) \left[ \dfrac{\partial f}{\partial y} - \dfrac{d}{dx}\left( \dfrac{\partial f}{\partial y'} \right) \right] dx = 0.\]</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The last statement is true for any arbitrary function <span class="math notranslate nohighlight">\(\eta(x)\)</span>, so we can conclude that the term in square brackets must be zero:</p>
<div class="math notranslate nohighlight">
\[\dfrac{\partial f}{\partial y} - \dfrac{d}{dx}\left( \dfrac{\partial f}{\partial y'} \right) = 0.\]</div>
<p>This is the <strong><a class="reference external" href="https://en.wikipedia.org/wiki/Euler%E2%80%93Lagrange_equation">Euler-Lagrange equation</a></strong> for a 1D problem.</p>
</div>
</section>
</section>
<section id="back-to-the-shortest-path-example">
<h3>Back to the Shortest Path Example<a class="headerlink" href="#back-to-the-shortest-path-example" title="Link to this heading">#</a></h3>
<p>Now let’s apply the Euler-Lagrange equation to our original problem of finding the shortest path between two points in a plane. We have:</p>
<div class="math notranslate nohighlight">
\[l = \int_{x_1}^{x_2} \sqrt{1 + y'(x)^2} dx.\]</div>
<p>Here, we can identify our function <span class="math notranslate nohighlight">\(f\)</span> as:</p>
<div class="math notranslate nohighlight">
\[f(y(x), y'(x), x) = \sqrt{1 + y'(x)^2}.\]</div>
<p>Let’s apply the Euler-Lagrange equation to this function.</p>
<div class="math notranslate nohighlight">
\[\dfrac{\partial f}{\partial y} - \dfrac{d}{dx}\left( \dfrac{\partial f}{\partial y'} \right) = 0.\]</div>
<p>We take the derivatives:</p>
<div class="math notranslate nohighlight">
\[\dfrac{\partial f}{\partial y} = 0\]</div>
<p>since <span class="math notranslate nohighlight">\(f\)</span> does not depend on <span class="math notranslate nohighlight">\(y\)</span>, only on <span class="math notranslate nohighlight">\(y'\)</span>. Now let’s compute the second term:</p>
<div class="math notranslate nohighlight">
\[\dfrac{\partial f}{\partial y'} = \dfrac{\partial}{\partial y'}\left( \sqrt{1 + y'(x)^2} \right)\]</div>
<div class="math notranslate nohighlight">
\[\dfrac{\partial f}{\partial y'} = \dfrac{1}{2} \left(1 + y'(x)^2\right)^{-1/2} 2y'(x)\]</div>
<div class="math notranslate nohighlight">
\[\dfrac{\partial f}{\partial y'} = \frac{y'(x)}{\sqrt{1 + y'(x)^2}}.\]</div>
<p>Let’s put all this together:</p>
<div class="math notranslate nohighlight">
\[0 = \dfrac{\partial f}{\partial y} - \dfrac{d}{dx}\left( \dfrac{\partial f}{\partial y'} \right)\]</div>
<div class="math notranslate nohighlight">
\[0 = 0 - \dfrac{d}{dx}\left(\frac{y'(x)}{\sqrt{1 + y'(x)^2}}\right).\]</div>
<p>This means that,</p>
<div class="math notranslate nohighlight">
\[\dfrac{d}{dx}\left(\frac{y'(x)}{\sqrt{1 + y'(x)^2}}\right) = 0\]</div>
<p>This implies that:</p>
<div class="math notranslate nohighlight">
\[\frac{y'(x)}{\sqrt{1 + y'(x)^2}} = C = \textrm{a constant}.\]</div>
<p>Or rearranging gives us:</p>
<div class="math notranslate nohighlight">
\[y'(x) = C\sqrt{1 + y'(x)^2}\]</div>
<div class="math notranslate nohighlight">
\[y'(x)^2 = C^2(1 + y'(x)^2)\]</div>
<div class="math notranslate nohighlight">
\[(1 - C^2)y'(x)^2 = C^2\]</div>
<div class="math notranslate nohighlight">
\[y'(x)^2 = \frac{C^2}{1 - C^2}\]</div>
<div class="math notranslate nohighlight">
\[y'(x) = \pm \sqrt{\frac{C^2}{1 - C^2}}\]</div>
<p>So that, <span class="math notranslate nohighlight">\(y'(x)\)</span> is a constant, call it <span class="math notranslate nohighlight">\(m\)</span>, which produces a linear solution.</p>
<div class="math notranslate nohighlight">
\[\dfrac{dy}{dx} = \sqrt{\frac{C^2}{1 - C^2}} = m\]</div>
<p>Integrating gives us:</p>
<div class="math notranslate nohighlight">
\[y(x) = mx + b\]</div>
<p>where <span class="math notranslate nohighlight">\(b\)</span> is a constant of integration. This is the equation of a straight line!</p>
</section>
</section>
<section id="example-snell-s-law">
<h2>Example: Snell’s Law<a class="headerlink" href="#example-snell-s-law" title="Link to this heading">#</a></h2>
<p>Let’s assume you are walking on the beach and need to get to a location in the water quickly. Where do you enter the water to minimize the time it takes to reach the location in the water? This is a classic problem in physics and can be solved using the Calculus of Variations.</p>
<p>Consider the picture below where you can move at a speed <span class="math notranslate nohighlight">\(v_1\)</span> on the shore and a speed <span class="math notranslate nohighlight">\(v_2\)</span> in the water. We know that <span class="math notranslate nohighlight">\(v_1 &gt; v_2\)</span>, so you can move faster on the shore than in the water. We aim to minimize the time it takes to reach the point <span class="math notranslate nohighlight">\(\langle x_2, y_2 \rangle\)</span> in the water from point <span class="math notranslate nohighlight">\(\langle x_1, y_1 \rangle\)</span> on the shore. We take the shoreline to be a line at <span class="math notranslate nohighlight">\(x = 0\)</span>. and the location we cross the shoreline is <span class="math notranslate nohighlight">\(\langle 0, y \rangle\)</span>.</p>
<p><img alt="Snell's Law Diagram" src="../../_images/snells_shore.png" /></p>
<p>Notice the angle that we approach the shoreline at, <span class="math notranslate nohighlight">\(\theta_1\)</span>, and the angle that we approach the target in the water, <span class="math notranslate nohighlight">\(\theta_2\)</span>.</p>
<p>The total time to travel from <span class="math notranslate nohighlight">\(\langle x_1, y_1 \rangle\)</span> to <span class="math notranslate nohighlight">\(\langle 0, y \rangle\)</span> and then to <span class="math notranslate nohighlight">\(\langle x_2, y_2 \rangle\)</span> is:</p>
<div class="math notranslate nohighlight">
\[T = t_1 + t_2 = \dfrac{d_1}{v_1} + \dfrac{d_2}{v_2}\]</div>
<p>where <span class="math notranslate nohighlight">\(d_1\)</span> is the distance from <span class="math notranslate nohighlight">\(\langle x_1, y_1 \rangle\)</span> to <span class="math notranslate nohighlight">\(\langle 0, y \rangle\)</span>, and <span class="math notranslate nohighlight">\(d_2\)</span> is the distance from <span class="math notranslate nohighlight">\(\langle 0, y \rangle\)</span> to <span class="math notranslate nohighlight">\(\langle x_2, y_2 \rangle\)</span>. We can write those distances in terms of the coordinates:</p>
<div class="math notranslate nohighlight">
\[d_1 = \sqrt{x_1^2 + (y - y_1)^2}\]</div>
<div class="math notranslate nohighlight">
\[d_2 = \sqrt{x_2^2 + (y_2 - y)^2}\]</div>
<p>This gives us:</p>
<div class="math notranslate nohighlight">
\[T = \dfrac{\sqrt{x_1^2 + (y - y_1)^2}}{v_1} + \dfrac{\sqrt{x_2^2 + (y_2 - y)^2}}{v_2}.\]</div>
<p>We want to minimize this time, <span class="math notranslate nohighlight">\(T\)</span>, by choosing the optimal point <span class="math notranslate nohighlight">\(y\)</span> where we cross the shoreline. We compute the derivative of <span class="math notranslate nohighlight">\(T\)</span> with respect to <span class="math notranslate nohighlight">\(y\)</span> and set it to zero:</p>
<div class="math notranslate nohighlight">
\[\dfrac{dT}{dy} = 0\]</div>
<div class="math notranslate nohighlight">
\[\dfrac{dT}{dy} = \dfrac{1}{2}\dfrac{1}{v_1}\left(x_1^2 + (y-y_1)^2\right)^{-1/2}(2)(y-y_1) + \dfrac{1}{2}\dfrac{1}{v_2}\left(x_2^2 + (y_2-y)^2\right)^{-1/2}(-2)(y_2-y) = 0\]</div>
<div class="math notranslate nohighlight">
\[\dfrac{dT}{dy} = \dfrac{1}{v_1}\left(\dfrac{y-y_1}{\sqrt{x_1^2 + (y-y_1)^2}}\right) - \dfrac{1}{v_2}\left(\dfrac{y_2-y}{\sqrt{x_2^2 + (y_2-y)^2}}\right) = 0\]</div>
<div class="math notranslate nohighlight">
\[\dfrac{dT}{dy} = \dfrac{1}{v_1}\left(\dfrac{y-y_1}{d_1}\right) - \dfrac{1}{v_2}\left(\dfrac{y_2-y}{d_2}\right) = 0\]</div>
<p>where the last step is just substituting in the expressions for <span class="math notranslate nohighlight">\(d_1\)</span> and <span class="math notranslate nohighlight">\(d_2\)</span>. Notice that those expressions are related to the angles we defined earlier. We can rewrite the expression in terms of the angles <span class="math notranslate nohighlight">\(\theta_1\)</span> and <span class="math notranslate nohighlight">\(\theta_2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\sin(\theta_1) = \frac{y - y_1}{d_1}\]</div>
<div class="math notranslate nohighlight">
\[\sin(\theta_2) = \frac{y_2 - y}{d_2}\]</div>
<p>This gives us:</p>
<div class="math notranslate nohighlight">
\[\dfrac{\sin(\theta_1)}{v_1} - \dfrac{\sin(\theta_2)}{v_2} = 0\]</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This is <a class="reference external" href="https://en.wikipedia.org/wiki/Snell%27s_law"><strong>Snell’s Law</strong></a>! It tells us that the ratio of the sine of the angles to the velocities is constant. This is a classic result in optics, but it also applies to this problem of finding the shortest path in a plane.</p>
<div class="math notranslate nohighlight">
\[\dfrac{\sin(\theta_1)}{v_1} = \dfrac{\sin(\theta_2)}{v_2}\]</div>
</div>
</section>
<section id="example-brachistochrone-problem">
<h2>Example: Brachistochrone Problem<a class="headerlink" href="#example-brachistochrone-problem" title="Link to this heading">#</a></h2>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Brachistochrone_problem">Brachistochrone problem</a> is a classic problem in the Calculus of Variations. It asks the question: “What is the shape of the curve that a bead will follow under the influence of gravity to reach the bottom in the shortest time?”  Here’s a great video from <a class="reference external" href="https://en.wikipedia.org/wiki/Steven_Strogatz">Steven Strogatz</a> that explains the problem and its solution.</p>
<p><a class="reference external" href="https://www.youtube.com/watch?v=Cld0p3a43fU"><img alt="Youtube Video on the Brachistochrone Problem" src="../../_images/Cld0p3a43fU.jpg" /></a></p>
<p>Source: <a class="reference external" href="https://www.youtube.com/watch?v=Cld0p3a43fU">https://www.youtube.com/watch?v=Cld0p3a43fU</a></p>
<p>The setup is below, there’s two points separated by a distance vertically and horizontally. What shape should we make a track so that a bead will roll down it in the shortest time?</p>
<p><img alt="The Brachistochrone Problem" src="../../_images/brachistochrone.png" /></p>
<p>The time it takes for the bead to roll down the curve is given by:</p>
<div class="math notranslate nohighlight">
\[T = \int_{1}^{2} \dfrac{ds}{v}\]</div>
<p>where <span class="math notranslate nohighlight">\(ds\)</span> is the differential arc length along the curve, and <span class="math notranslate nohighlight">\(v\)</span> is the velocity of the bead at that point. The generic step is the same as before:</p>
<div class="math notranslate nohighlight">
\[ds = \sqrt{dx^2 + dy^2}.\]</div>
<section id="velocity-of-the-bead">
<h3>Velocity of the Bead<a class="headerlink" href="#velocity-of-the-bead" title="Link to this heading">#</a></h3>
<p>What about <span class="math notranslate nohighlight">\(v\)</span>? Because the bead is moving under the influence of gravity, we can use conservation of energy to find the velocity. Note that we don’t model the rolling of the bead, just the motion down the track. We also neglect all frictional forces. This is a major simplification, but it will give us an analytical solution.</p>
<div class="math notranslate nohighlight">
\[\Delta K + \Delta U = 0\]</div>
<p>If the bead starts from rest, then <span class="math notranslate nohighlight">\(v_i = 0\)</span>, and we can write:</p>
<div class="math notranslate nohighlight">
\[\dfrac{1}{2}mv^2 - \dfrac{1}{2}m(0)^2 + mg(\Delta y) = 0,\]</div>
<div class="math notranslate nohighlight">
\[v = \sqrt{2g\Delta y}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta y = y_1 - y_2 &gt; 0\)</span>. This is the change in height of the bead as it rolls down the track. We can express this in terms of the coordinates of the two points, <span class="math notranslate nohighlight">\(y_1\)</span> and <span class="math notranslate nohighlight">\(y_2\)</span>.</p>
<p>Let’s move the origin to the top of the track and measure <span class="math notranslate nohighlight">\(+y\)</span> downwards. Thus, for any point on the track, we have:</p>
<div class="math notranslate nohighlight">
\[v = \sqrt{2gy}.\]</div>
<p>We can now write the integral again,</p>
<div class="math notranslate nohighlight">
\[T = \int_{1}^{2} \dfrac{ds}{v} = \int_{1}^{2} \dfrac{\sqrt{dx^2 + dy^2}}{\sqrt{2gy}}.\]</div>
<p>We notice that we can factor out a <span class="math notranslate nohighlight">\(dy\)</span> term from the square root in the numerator:</p>
<div class="math notranslate nohighlight">
\[\sqrt{dx^2 + dy^2} = dy\sqrt{\left(\frac{dx}{dy}\right)^2 + 1} = dy \sqrt{x'^2 + 1}\]</div>
<p>where <span class="math notranslate nohighlight">\(x' = \frac{dx}{dy}\)</span>. This gives us:</p>
<div class="math notranslate nohighlight">
\[T = \dfrac{1}{\sqrt{2g}}\int_{0}^{y_2} dy \dfrac{\sqrt{x'^2 + 1}}{\sqrt{y}}.\]</div>
<p>We can identify our function <span class="math notranslate nohighlight">\(f\)</span> as:</p>
<div class="math notranslate nohighlight">
\[f(x,x',y) = f(x',y) = \dfrac{\sqrt{x'^2 + 1}}{\sqrt{y}}.\]</div>
<p>Because <span class="math notranslate nohighlight">\(f\)</span> does not depend on <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(\partial f/\partial x = 0\)</span>. So that the Euler-Lagrange equation simplifies to:</p>
<div class="math notranslate nohighlight">
\[\dfrac{d}{dy}\left(\dfrac{\partial f}{\partial x'}\right) = 0.\]</div>
<p>Or that this partial derivative must be a constant:</p>
<div class="math notranslate nohighlight">
\[\dfrac{\partial f}{\partial x'} = \textrm{a constant},\]</div>
<div class="math notranslate nohighlight">
\[\dfrac{\partial f}{\partial x'} = \dfrac{x'}{\sqrt{x'^2 + 1}\sqrt{y}} = \sqrt{C},\]</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span> is a constant. We square both sides to get:</p>
<div class="math notranslate nohighlight">
\[\dfrac{x'^2}{(x'^2 + 1)y} = C.\]</div>
<p>Knowing the solution ahead of time, we choose the constant <span class="math notranslate nohighlight">\(C = \frac{1}{2a}\)</span>. This gives us:</p>
<div class="math notranslate nohighlight">
\[\dfrac{x'^2}{(x'^2 + 1)y} = \frac{1}{2a}.\]</div>
<p>Some more algebra gives us:</p>
<div class="math notranslate nohighlight">
\[2ax'^2 = y(x'^2 + 1),\]</div>
<div class="math notranslate nohighlight">
\[(2a - y)x'^2 = y,\]</div>
<div class="math notranslate nohighlight">
\[x'^2 = \frac{y}{2a - y},\]</div>
<p>where <span class="math notranslate nohighlight">\(x' = \frac{dx}{dy}\)</span>. We can now integrate this to find the shape of the curve:</p>
<div class="math notranslate nohighlight">
\[x = \int \sqrt{\frac{y}{2a - y}} dy.\]</div>
<p>This integral will give us the shape of the curve <span class="math notranslate nohighlight">\(x(y)\)</span>, but to solve it we need to use a substitution.</p>
<p>Let <span class="math notranslate nohighlight">\(y = a(1 - \cos(\theta))\)</span>. Thus, <span class="math notranslate nohighlight">\(dy = a\sin(\theta)d\theta\)</span>. This gives us:</p>
<div class="math notranslate nohighlight">
\[x(y(\theta)) = \int \sqrt{\frac{y(\theta)}{2a - y(\theta)}} dy\]</div>
<div class="math notranslate nohighlight">
\[x(y(\theta)) = \int \sqrt{\frac{a(1 - \cos(\theta))}{2a - a(1 - \cos(\theta))}} a\sin(\theta)d\theta\]</div>
<div class="math notranslate nohighlight">
\[x(y(\theta)) = a \int \sqrt{\frac{(1-\cos\theta)}{(1+\cos\theta)}} \sin(\theta)d\theta.\]</div>
<p>Note that <span class="math notranslate nohighlight">\(\sin \theta = \sqrt{1 - \cos^2 \theta} = \sqrt{(1 - \cos\theta)(1 + \cos\theta)}\)</span>. This allows us to simplify the integral:</p>
<div class="math notranslate nohighlight">
\[x(y(\theta)) = a \int \sqrt{\frac{(1-\cos\theta)^2(1+\cos\theta)}{(1+\cos\theta)}} d\theta\]</div>
<div class="math notranslate nohighlight">
\[x(y(\theta)) = a \int \sqrt{(1 - \cos\theta)^2} d\theta\]</div>
<div class="math notranslate nohighlight">
\[x(y(\theta)) = a \int (1 - \cos\theta) d\theta\]</div>
<div class="math notranslate nohighlight">
\[x(y(\theta)) = a \left(\theta - \sin(\theta)\right) + C\]</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span> is a constant of integration.</p>
<p>With initial conditions <span class="math notranslate nohighlight">\(x(0) = 0\)</span> when <span class="math notranslate nohighlight">\(y(0) = 0\)</span> at <span class="math notranslate nohighlight">\(t=0\)</span> and <span class="math notranslate nohighlight">\(\theta = 0\)</span>, we find that <span class="math notranslate nohighlight">\(C = 0\)</span>. So the solution is:</p>
<div class="math notranslate nohighlight">
\[x(\theta) = a\left(\theta - \sin(\theta)\right)\]</div>
<div class="math notranslate nohighlight">
\[y(\theta) = a(1 - \cos(\theta)).\]</div>
<p>This is the “cycloid” curve that the bead will follow to minimize the time it takes to roll down the track. We can plot this curve to visualize it.</p>
<p>What is so interesting about this curve is that it is <a class="reference external" href="https://en.wikipedia.org/wiki/Isochronous">isochronous</a>, meaning that all beads released from rest at any point on the curve will reach the bottom at the same time, regardless of where they start.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Plot a cycloid path for comparison</span>
<span class="c1">## $$x(\theta) = a\left(\theta - \sin(\theta)\right)$$</span>
<span class="c1">## $$y(\theta) = a(1 - \cos(\theta)).$$</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-v0_8-colorblind&#39;</span><span class="p">)</span>

<span class="c1"># Cycloid parameters</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Radius of the rolling circle</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># Parameter for the cycloid</span>

<span class="c1"># Cycloid equations</span>
<span class="n">x_cycloid</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">theta</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
<span class="n">y_cycloid</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>

<span class="c1"># Create the plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>  <span class="c1"># Create a new figure and axis</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_cycloid</span><span class="p">,</span> <span class="n">y_cycloid</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;C1o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Start&#39;</span><span class="p">)</span>  <span class="c1"># Starting point of the cycloid</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_cycloid</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_cycloid</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;C2o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;End&#39;</span><span class="p">)</span>  <span class="c1"># Ending point of the cycloid</span>

<span class="c1"># Set labels and title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cycloid Path&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>  <span class="c1"># Add a legend to the plot</span>

<span class="c1"># Show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Add grid for better readability</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Display the plot</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/a144ee9599841abc161019cf9f035658d6be1667762d75520ef977626ce47e89.png" src="../../_images/a144ee9599841abc161019cf9f035658d6be1667762d75520ef977626ce47e89.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="11_start.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Week 11 - Calculus of Variations</p>
      </div>
    </a>
    <a class="right-next"
       href="12_start.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Week 12 - The Principle of Least Action</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#canonical-conceptualization-finding-the-shortest-path-in-a-plane">Canonical Conceptualization - Finding the Shortest Path in a Plane</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-of-the-problem">Setup of the Problem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deriving-the-euler-lagrange-equation">Deriving the Euler-Lagrange Equation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-by-parts">Integration by Parts</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#back-to-the-shortest-path-example">Back to the Shortest Path Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-snell-s-law">Example: Snell’s Law</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-brachistochrone-problem">Example: Brachistochrone Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#velocity-of-the-bead">Velocity of the Bead</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>